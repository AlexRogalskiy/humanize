h1. Humanize for Java !https://secure.travis-ci.org/mfornos/humanize.png?branch=master(Build Status)!:http://travis-ci.org/mfornos/humanize

Humanize is a Java facility for adding a "human touch" to data. It is thread-safe and supports per-thread internationalization. 

Exists in two flavors: *humanize-slim* and *humanize-icu*. Humanize-slim only depends on guava and standard Java APIs while humanize-icu provides a concise facade for access to the "International Components for Unicode":http://icu-project.org/ (ICU) Java APIs.

h2. Getting Started

h3. Maven

Current version:

bc.. <humanize.version>1.1.3</humanize.version>

p. For the *slim flavor* write the following in your _pom_:

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-slim</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. For the *full-fledged ICU* distribution:

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-icu</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. 

h2. Dependencies

h3. Humanize-slim

* guava 14.0.1
* prettytime 3.0.2.Final

h3. Humanize-icu

* humanize-slim ${humanize.version}
* icu4j 51.1

_If you need customize the data included by default in the ICU distribution (all features and languages ~7.1MB), the "ICU Data Library Customizer":http://apps.icu-project.org/datacustom/ may be useful._

h2. Usage

Humanize usage is quite simple.

# Import the static methods of the Humanize class that you want to call.
# Invoke these methods.

bc.. import static humanize.Humanize.binaryPrefix;
 
class SomeClass {

  void doSomething() {
  
    String size = binaryPrefix(1325899906842624L); // 1.18 PB
    
  }
  
}

p. 

h2. Documentation

* "Documentation for humanize-slim":http://mfornos.github.com/humanize/humanize-slim-apidocs/index.html
* "Documentation for humanize-icu":http://mfornos.github.com/humanize/humanize-icu-apidocs/index.html

h2. Examples

h3. Date&Time

bc.. naturalTime(new Date()); // == "moments ago"
naturalTime(new Date(1000 * 60 * 60 * 24 * 1), new Date(0)); // == "1 day ago"
naturalTime(new Date(3155792597470L * 3L), new Date(0)); // == "3 centuries ago"
naturalTime(new Date(0), new Date(1000 * 60 * 12)); // == "12 minutes from now"
naturalTime(new Date(0), new Date(1000 * 60 * 60 * 24 * 1)); // == "1 day from now"
naturalTime(new Date(0), new Date(2629743830L * 3L)); // == "3 months from now"

p. 

h3. Text

p. *Pluralize*

bc.. pluralize("one", "{0}", 1);    // == "one"
pluralize("one", "{0}", 2);         // == "2"
pluralize("one", "{0}", "none", 0); // == "none"

bc.. pluralize("one {1}.", "{0} {1}s.", 1, "disk");       // == "one disk."
pluralize("one {1}.", "{0} {1}s.", 2, "disk");            // == "2 disks."
pluralize("one {1}.", "{0} {1}s.", "no {1}.", 0, "disk"); // == "no disk."

bc.. MessageFormat msg = pluralizeFormat("There {0} on {1}.::are no files::is one file::are {2} files");
msg.render(0, "disk");    // == "There are no files on disk."
msg.render(1, "disk");    // == "There is one file on disk."
msg.render(1000, "disk"); // == "There are 1,000 files on disk."

bc.. MessageFormat msg = pluralizeFormat("nothing::one thing::{0} things");
msg.render(-1); // == "nothing"
msg.render(0);  // == "nothing"
msg.render(1);  // == "one thing"
msg.render(2);  // == "2 things"

bc.. MessageFormat msg = pluralizeFormat("one thing::{0} things");
msg.render(-1); // == "-1 things"
msg.render(0);  // == "0 things"
msg.render(1);  // == "one thing"
msg.render(2);  // == "2 things"

p. *Slugify*

bc.. slugify("Cet été, j’en ai rien à coder"); // == "cet-ete-jen-ai-rien-a-coder" 

p. *Interpolation*

p. Emoji aliases:

bc.. EmojiInterpolator.interpolateAlias(
        "<img src=\"imgs/{0}.png\" title=\"{0}\" />;", 
        "Hi :sparkles:!"); 

// == "Hi <img src=\"imgs/sparkles.png\" title=\"sparkles\" />!"

p. Emoji chars:

bc.. EmojiInterpolator.interpolateChars(
        "<img src=\"imgs/{0}.png\" />;", 
        "Hi \uE025!"); 

// == "Hi <img src=\"imgs/uE025.png\" />!"

h3. Parse

p. *Date & Time*

bc.. parseISODateTime("2011-09-14T15:22:01Z");
parseISOTime("15:22:01Z");

// Smart

parseSmartDate("1.2.12", "dd/MM/yy", "yyyy/MM/dd", "dd/MM/yyyy");

p. 

h3. More

p. _See @src/test/.../TestHumanize@ for complete examples._

h2. Principal Methods

h3. Date&Time

|_. Method |_. Description |_. Output |_. Slim |_. ICU |
| naturalDay | For dates that are the current day or within one day, return 'today','tomorrow' or 'yesterday', as appropriate. | 'today', 'tomorrow', 'yesterday' or the date formatted | ✔ | ✔ |
| naturalTime | Computes both past and future relative dates. | '2 days from now', '3 decades ago', '3 minutes from now', 'moments ago', etc. | ✔ | ✔ |
| nanoTime | Formats a number of nanoseconds as the proper ten power unit. | '1.5µs', '10.51ms', '30ns', etc. | ✔ | - |
| duration | Formats a number of seconds as hours, minutes and seconds. | '1 sec.', '1:02:10', etc.| ✔ | ✔ |
| smartDateFormat | Guesses the best locale-dependent pattern to format the date/time fields that the skeleton specifies. | skeleton 'MMMd' produces '11 Dec.' | - | ✔ |
| prettyTimeFormat | Returns a PrettyTime instance for the current thread. | - | ✔ | - |

h3. Numbers

|_. Method |_. Description |_. Output |_. Slim |_. ICU |
| ordinal | Converts a number to its ordinal as a string. | '1st', '2nd', '3rd', etc. | ✔ | ✔ |
| spellBigNumber | Converts a big number to a friendly text representation. | '2.3 thousand', '1 million', '-1.55 billion', '3 decillion', '2 googol', etc. | ✔ | - |
| spellDigit | For decimal digits, returns the number spelled out. | 'one', 'two', 'three', etc. | ✔ | - |
| spellNumber | Converts the given number to words. | 'twenty-three', 'two thousand eight hundred and forty', 'one million four hundred and twelve thousand six hundred and five', etc.  | - | ✔ |

h3. Units

|_. Method |_. Description |_. Output |_. Slim |_. ICU |
| binaryPrefix | Converts a given number to a string preceded by the corresponding binary International System of Units (SI) prefix. | '2 bytes', '1.5 kB', '5 MB', '1.18 PB', etc. | ✔ | - |
| metricPrefix | Converts a given number to a string preceded by the corresponding decimal multiplicative prefix.  | '100k', '1M', '3.5M', etc.  | ✔ | - |
| formatCurrency | Smartly formats the given number as a monetary amount. | '£34', '£1,000', '£12.50', etc. | ✔ | ✔ |
| formatPluralCurrency | Smartly formats the given number as a monetary amount in plural form. | '34 British pounds sterling', '1,500.55 British pounds sterling', '1 euro', etc. | - | ✔ |
| formatPercent | Formats the given ratio as a percentage. | '500%', '56%', etc.  | ✔ | ✔ |

h3. Text

|_. Method |_. Description |_. Output |_. Slim |_. ICU |
| pluralize | Applies the proper format for a given plural state. | - | ✔ | - |
| pluralizeFormat | Constructs a message with pluralization logic by the means of ChoiceFormat. Refer to _messageFormat_ for pluralization using CLDR Plural Rules. | - | ✔ | - |
| camelize | Makes a phrase camel case. Spaces, hyphens, underscores and dots will be removed. | - | ✔ | - |
| capitalize | Capitalizes a string (first letter uppercase and the rest lowercase). | - | ✔ | - |
| decamelize | Converts a camel case string into a human-readable name. | - | ✔ | - |
| titleize | Capitalize all the words, and replace some characters in the string to create a nice looking title. | - | ✔ | - |
| transliterate | Strips diacritic marks. | - | ✔ | - |
| slugify | Transforms a text into a representation suitable to be used in an URL. | - | ✔ | - |
| mask | Formats the given text with the mask specified. | for '12345G' with mask '__ ___/_' produces '12 345/G' | ✔ | - |
| wordWrap | Truncate a string to the closest word boundary after a number of characters. | - | ✔ | - |
| messageFormat | Returns an ICU or extended MessageFormat instance for the current thread. | - | ✔ | ✔ |
| replaceSupplementary | Replaces characters outside the Basic Multilingual Plane with their name. | 'SMILING FACE WITH SMILING EYES' for the corresponding Emoji char | ✔ | ✔ |

h2. Supported languages

*humanize-slim*: _naturalTime_ supports over 25 languages, see "prettytime":http://ocpsoft.org/prettytime. Rest of methods have support for english and spanish.

*humanize-icu*: all languages supported by the "ICU APIs":http://icu-project.org/.

h3. Custom languages

If you want to add support for other languages simply put a properties file named *Humanize_{your_locale}.properties* under the classpath: *i18n*.

h2. Extensible Message Formats

If you want to plug in your own formats then place a @META-INF/services/humanize.spi.FormatProvider@ file inside your jar. This file must contain a list of the full qualified class names of your @FormatProvider@ implementations, separated by carriage return. Also, you can register manually your format factories on the message formatter.

h3. Built-in Humanize Extended Formats

Create a file @META-INF/services/humanize.spi.FormatProvider@ with the following content:

bc.. humanize.text.HumanizeFormatProvider
humanize.text.MaskFormat

p. Use it

bc.. Humanize.format("{0,humanize,ordinal} greetings", 1); // == "1st greetings"

h2. Cache configuration

By default the caches are configured to expire after 1 hour past the last access. If you want to change this behavior you need to provide a @humanize.properties@ file, or specify the location of a properties file using the @humanize.config@ system property, with a CacheBuilderSpec string configuration like this:

bc.. cache.builder.spec:expireAfterAccess=15m

p. The value must follow the CacheBuilderSpec syntax. The string syntax is a series of comma-separated keys or key-value pairs, each corresponding to a CacheBuilder method.

* concurrencyLevel=[integer]: sets CacheBuilder.concurrencyLevel.
* initialCapacity=[integer]: sets CacheBuilder.initialCapacity.
* maximumSize=[long]: sets CacheBuilder.maximumSize.
* maximumWeight=[long]: sets CacheBuilder.maximumWeight.
* expireAfterAccess=[duration]: sets CacheBuilder.expireAfterAccess(long, java.util.concurrent.TimeUnit).
* expireAfterWrite=[duration]: sets CacheBuilder.expireAfterWrite(long, java.util.concurrent.TimeUnit).
* refreshAfterWrite=[duration]: sets CacheBuilder.refreshAfterWrite(long, java.util.concurrent.TimeUnit).
* weakKeys: sets CacheBuilder.weakKeys().
* softValues: sets CacheBuilder.softValues().
* weakValues: sets CacheBuilder.weakValues().

Durations are represented by an integer, followed by one of "d", "h", "m", or "s", representing days, hours, minutes, or seconds respectively. (There is currently no syntax to request expiration in milliseconds, microseconds, or nanoseconds.) 

h2. Extensions

h3. The Unified Code for Units of Measure (UCUM)

Humanize provides a module called *humanize-ucum* that adds JSR-275* support.

Usage:

Declare the Maven dependency

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-ucum</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. ... and format some messages

bc.. Humanize.format("Hello from measures at {0, measure}", Measure.valueOf(150, NonSI.MILES_PER_HOUR)); 
// == "Hello from measures at 150 mph"

p. * _This will be replaced by Units of Measurement API when it is available in Maven central repo._ 

h3. Joda Time

p. Humanize provides a module called *humanize-joda* that adds support for Joda time formats.

Usage:

Declare the Maven dependency

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-joda</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. ... and format some messages

bc.. Humanize.format("hello {0, joda.time}!!", new DateTime(0)); 
// == "hello 1/1/70!!"

mf = Humanize.messageFormatInstance("hello {0, joda.period}!!", Locale.GERMAN);
mf.render(new Period(0, 100000));
// == "hello 1 Minute und 40 Sekunden!!"
    
Humanize.format("hello {0, joda.iso.time, basic.week.date.time.no}!!", new DateTime(0));
// == "hello 1970W014T010000+0100!!"

p. Note that it supports almost any Joda format as subformat. See FormatNames for details.

h3. Taglib

p. Humanize Tag library.

Usage:

Declare the Maven dependency

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-taglib</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. Use it in a page

bc.. <%@ taglib prefix="hmnz" uri="http://mfornos.github.com/humanize/taglib" %>

<hmnz:metricPrefix value="100000000" />
<hmnz:pluralize value="0" one="something" many="{0} things" none="nothing" />
<hmnz:pluralizeMessage value="0" template="nothing::something::{0} things" />

p. 
* "TLD documentation":http://mfornos.github.com/humanize/humanize-taglib-tlddoc/index.html
* See @humanize-taglib/src/integration/webapp@ for a complete example.

h3. Java Server Faces

p. Humanize JSF.

Usage:

Declare the Maven dependency

bc.. <dependency>
  <groupId>com.github.mfornos</groupId>
  <artifactId>humanize-jsf</artifactId>
  <version>${humanize.version}</version>
</dependency>

p. Use it in a page

bc.. <html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:hmnz="http://mfornos.github.com/jsf/humanize">

<h:outputText value="100000000" converter="humanize.MetricPrefix" />
<h:outputText value="nothing::something::{0} things">
  <hmnz:pluralize value="0" />
</h:outputText>
<h:outputFormat value="hi {0,humanize,binary.prefix}!">
  <f:param value="#{10}" />
</h:outputFormat>

p. 
* See @humanize-jsf/src/integration/webapp@ for a complete example.

h2. Integrations

h3. Handlebars Helper

Humanize is integrated in the awesome "Handlebars.java":https://github.com/jknack/handlebars.java project.


h2. Epilog

Have fun and stay fresh!

